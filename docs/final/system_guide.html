<html>
<head>
	<meta charset="utf-8">
	<title>ASvis &ndash; System guide</title>
	<link rel="stylesheet" href="main.css">
</head>
<body>

<header>
	<hgroup>
		<h1>ASvis</h1>
		<h2>Dokumentacja</h2>
		<h3>Opis systemu</h3>
	</hgroup>
	
	<nav>
		<h1>Spis treści</h1>
		<ol>
			<li><a href="#modules">Moduły</a></li>
			<li><a href="#backend">Backend</a></li>
			<li><a href="#rest">REST API</a></li>
			<li><a href="#frontend">Frontend</a></li>
		</ol>
	</nav>
</header>

<section id="modules">	
		<h1>Moduły</h1>
		
		<p>Aplikacja składa się z dwóch modułów: <a href="#backend">Backendu</a> i <a href="#frontend">Frontendu</a>.</p>
		<p><a href="#backend">Backend</a> odpowiedzialny jest za dostarczanie danych <a href="#frontend">Frontendowi</a>. Realizuje to poprzez <a href="#rest">RESTowe API</a>.</p>
		<p><a href="#frontend">Frontend</a> odpowiada za wyświetlanie GUI aplikacji. Żądania użytkownika realizuje odpytując <a href="#backend">Backend</a></p>
</section>

<section id="backend">
	<h1>Backend</h1>
	
	<p>Backend wykonuje się po stronie serwera. Jest to część napisana w całości w języku PHP. Backend odpytuje bazy danych, przetrwarza otrzymane wyniki, realizuje zadania przeszukiwania grafu.</p>
</section>
	
<section id="rest">
	<h1>REST API</h1>
	
	<p>Backend udostępnia zasoby za pomocą RESTowego API.</p>
	<h2>ASy</h2>			
	<h3>GET /nodes/find/[number]</h3>
	<p>Wyszukuje ASy po numerze, zwraca w kolejności alfabetycznej.</p>
	<ul>
		<li>parametry:
			<ul>
				<li>number [int] - wyszukuje na zasadzie LIKE value%</li>
			</ul>
		</li>
		<li>
			<p>przykład: GET /node/find/345 - wyszukuje wszystkie numery wierzchołków rozpoczynające się od "345"</p>
			<p>odpowiedź:</p>
			<pre><code>{
    "34567": {"name":"AS34567"}
    "34579": {"name":"AS34579"}
    "345": {"name":"AS345"}
}			</code></pre>
		</li>
	</ul>
	<h3>POST /nodes/meta</h3>
	
	<p>Podaje metadane ASów o numerach przekazanych w parametrze - pule adresów.</p>
	<ul>
		<li>parametry:
			<ul>
				<li>numbers [str] - przykład: "[1234,2345,52345,234523]"</li>
			</ul>
		</li>
		<li>
			<p>przykład: POST /nodes/meta</p>
			<p>odpowiedź:</p>
			<pre><code>{
    "1234": {"name":"AS1234", "pools":[{"ip":"193.110.32.0","netmask":21}, ...]},
    "4234": {"name":"AS4234", "pools":[{"ip":"198.136.146.0","netmask":12, ...}, ...]},
}			</code></pre>
		</li>
	</ul>

	<h2>Struktury</h2>
	<h3>GET /structure/graph/[node_number]/[depth]</h3>
	<p>Podaje strukturę połączeń grafu ASów, dodatkowo listę numerów znalezionych ASów posortowaną wg ilości połączeń oraz listę numerów znalezionych ASów posortowaną wg odległości od ASa źródłowego</p>
	<ul>
		<li>parametry:
			<ul>
				<li>node_number [int]</li>
				<li>depth [int]</li>
			</ul>
		</li>
		<li>
			<p>przykład: POST /structure/graph/345/3 - pobierz strukturę grafu od wierzchołka 345 do 3 połączeń wgłąb</p>
			<p>odpowiedź:</p>
			<pre><code>{
    "structure":{
        "306":{
            "out":[316,317,...,575],
            "in":[316,317,...,575],
            "distance":0,
            "weight":68
        },
        "306":{
            ...
        },
        ...
    },
    "weight_order":[306,575,...,343],
    "distance_order":[306,352,...,1733]
}			</code></pre>
		</li>
	</ul>

	<h3>GET /structure/tree/[node_number]/[height]/[dir]</h3>
	<p>Pobiera strukturę drzewa od ASa o podanym numerze o danej wysokości i kierunku. Patrz rozdział "Wyszukiwanie drzew" w podręczniku użytkownika.</p>
	<ul>
		<li>parametry:
			<ul>
				<li>node_number [int]</li>
				<li>height [int]</li>
				<li>dir [string] - przyjmowane wartości: "in", "out", "both"</li>
			</ul>
		</li>
		<li>
			<p>przykład: GET /structure/tree/306/2/out - zwraca strukturę nodów, do których download danych spoza struktury odbywa się jedynie poprzez główny wierzchołek</p>
			<p>odpowiedź:</p>
			<pre><code>{
    "structure":{
        "306":{
            "out":[316,317,...,575],
            "in":[316,317,...,575],
            "distance":0,
            "weight":68
        },
        "306":{
            ...
        },
        ...
    },
    "weight_order":[306,575,...,343],
    "distance_order":[306,352,...,1733]
}			</code></pre>
		</li>
	</ul>
	
	<h3>GET /structure/path/[num_start]/[num_end]/[dir]</h3>
	<p>Podaj ścieżkę pomiędzy podanym ASem startowym i docelowym szukając w zadanym kierunku.</p>
	<ul>
		<li>params:
			<ul>
				<li>node_start [int]</li>
				<li>num_stop [int]</li>
				<li>dir [string] - przyjmowane wartości: "up", "down", "both"</li>
			</ul>
		</li>
		<li>
			<p>przykład: GET /structure/paths/306/27066/both - zwraca tablicę zawierającą struktury nodów, które reprezentują najkrótsze znalezione ścieżki połączeń "up" i "down" od noda końcowego do początkowego.</p>
			<p>odpowiedź:</p>
			<pre><code>{
	"paths":[[306,575,27064,...,27066]],
	"depth_left":3,
	"depth_right":2
}			</code></pre>
		</li>
	</ul>

	<h2>Połączenia</h2>
	<h3>GET /connections/meta/[num_for]</h3>
	<p>Wyszukuje informacje na temat połączeń podanego wierzchołka.</p>
	<ul>
		<li>parametry:
			<ul>
				<li>num_for [int]</li>
			</ul>
		</li>
	
		<li>
			<p>przykład: GET /connections/meta/345 - wyszukuje informacje na temat połączeń wierzchołka "345"</p>
			<p>odpowiedź:</p>
			<pre><code>[
	{"with":306,"status":0,"dir":"up"},
	....
]			</code></pre>
		</li>
	</ul>
	
<section id="frontend">
	<li><strong>Frontend</strong>
	</li>
</section>

</body>
</html>
